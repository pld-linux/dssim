--- dssim-1.3.2/meson.build.orig	2016-05-05 14:02:11.000000000 +0200
+++ dssim-1.3.2/meson.build	2017-07-28 20:57:02.888208491 +0200
@@ -5,18 +5,17 @@
 dssim_sources = ['src/main.c',
 		 'src/rwpng.c']
 
+cc = meson.get_compiler('c')
 c_args = ['-DNDEBUG',
-	  '-O3',
 	  '-fstrict-aliasing',
 	  '-ffast-math',
-	  '-funroll-loops',
 	  '-fomit-frame-pointer',
 	  '-ffinite-math-only',
 	  '-Wall',
 	  '-std=c99']
 
-mathlib = find_library('m', required : true)
-zlib = find_library('z', required : true)
+mathlib = cc.find_library('m', required : true)
+zlib = cc.find_library('z', required : true)
 
 libdssim = shared_library('dssim-lib',
 			  dssim_lib_sources,
@@ -27,7 +26,8 @@
 
 h = install_headers ('src/dssim.h')
 
-pkgconfig_gen(libraries : libdssim,
+pkg = import('pkgconfig')
+pkg.generate( libraries : libdssim,
 	      subdirs : '.',
 	      name : 'libdssim',
 	      filebase : 'dssim',
